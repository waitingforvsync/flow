
.start
;	JSR cls
	JSR enableScreen
	LDA #LO(ScreenBaseAddr DIV 8):STA reqScrn
	LDA #HI(ScreenBaseAddr DIV 8):STA reqScrn+1
	LDA #LO(ScreenBaseAddr):STA scrnBase
	LDA #HI(ScreenBaseAddr):STA scrnBase+1
	LDA #0:STA reqLine

	LDA #6*8:LDY #22
	JSR createSpriteAtY
	LDA #10:STA SpriteNewX0,X:STA SpriteOldX0,X
	LDA #16:STA SpriteNewX1,X:STA SpriteOldX1,X
	LDA #LO(spritedata):STA SpriteAddrLo,X
	LDA #HI(spritedata):STA SpriteAddrHi,X

	LDA #12*8:LDY #22
	JSR createSpriteAtY
	LDA #40:STA SpriteNewX0,X:STA SpriteOldX0,X
	LDA #46:STA SpriteNewX1,X:STA SpriteOldX1,X
	LDA #LO(spritedata):STA SpriteAddrLo,X
	LDA #HI(spritedata):STA SpriteAddrHi,X

.mainLoop
;	LDA #98
;	.waitforkey STA &FE4F:BIT &FE4F:BPL waitforkey
;	.waitforkey2 STA &FE4F:BIT &FE4F:BMI waitforkey2

	INC reqScrn:BNE P%+4:INC reqScrn+1
	LDA reqLine:CLC:ADC #1:AND #7:STA reqLine
	BNE sameLine
	LDA reqScrn:CLC:ADC #ScreenWidth:STA reqScrn
	LDA reqScrn+1:ADC #0:CMP #&10:BCC P%+4:LDA #HI(ScreenBaseAddr DIV 8):STA reqScrn+1
	.sameLine
	
	LDA #1:STA reqUpdate
	.wait LDA reqUpdate:BNE wait
	
	JMP mainLoop
